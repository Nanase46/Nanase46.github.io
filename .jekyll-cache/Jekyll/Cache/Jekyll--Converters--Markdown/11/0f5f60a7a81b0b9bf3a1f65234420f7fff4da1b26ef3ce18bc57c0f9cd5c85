I"Ù<h1 id="cobbler-è‡ªåŠ¨åŒ–éƒ¨ç½²å®è·µ">Cobbler è‡ªåŠ¨åŒ–éƒ¨ç½²å®è·µ</h1>

<blockquote>

  <p>è¿ç»´è‡ªåŠ¨åŒ–åœ¨ç”Ÿäº§ç¯å¢ƒä¸­å æ®ç€ä¸¾è¶³è½»é‡çš„åœ°ä½ï¼Œå°¤å…¶æ˜¯é¢å¯¹å‡ ç™¾å°ï¼Œå‡ åƒå°ç”šè‡³å‡ ä¸‡å°çš„æœåŠ¡å™¨æ—¶ï¼Œä»…ä»…æ˜¯å®‰è£…æ“ä½œç³»ç»Ÿï¼Œå¦‚æœä¸é€šè¿‡è‡ªåŠ¨åŒ–æ¥å®Œæˆï¼Œ
æ ¹æœ¬æ˜¯ä¸å¯æƒ³è±¡çš„ã€‚é¢å¯¹ç”Ÿäº§ç¯å¢ƒä¸­ä¸åŒæœåŠ¡å™¨çš„éœ€æ±‚ï¼Œè¯¥å¦‚ä½•å®ç°æ‰¹é‡éƒ¨ç½²å¤šç‰ˆæœ¬çš„æ“ä½œç³»ç»Ÿå‘¢ï¼Ÿ
Cobbler ä¾¿å¯ä»¥çš„æ»¡è¶³è¿™ä¸€å®é™…éœ€æ±‚ï¼Œå®ç°å¤šç‰ˆæœ¬æ“ä½œç³»ç»Ÿæ‰¹é‡éƒ¨ç½²ã€‚</p>
</blockquote>

<h2 id="1-cobbler-ç®€ä»‹">1 Cobbler ç®€ä»‹</h2>
<blockquote>

  <p>Cobbler æ˜¯ä¸€ä¸ªå¿«é€Ÿç½‘ç»œå®‰è£… Linux çš„æœåŠ¡ï¼Œè€Œä¸”ç»è¿‡è°ƒæ•´ä¹Ÿå¯ä»¥æ”¯æŒç½‘ç»œå®‰è£… Windowsã€‚<br />
è¯¥å·¥å…·ä½¿ç”¨ Python å¼€å‘ï¼Œå°å·§è½»ä¾¿ï¼ˆæ‰ 15 k è¡Œ Python ä»£ç ï¼‰ï¼Œä½¿ç”¨ç®€å•çš„å‘½ä»¤å³å¯å®ŒæˆPXEç½‘ç»œå®‰è£…ç¯å¢ƒçš„é…ç½®ï¼Œ
åŒæ—¶è¿˜å¯ä»¥ç®¡ç† DHCPã€DNSã€TFTPã€RSYNC ä»¥åŠ YUM ä»“åº“ã€æ„é€ ç³»ç»Ÿ ISO é•œåƒã€‚<br />
Cobbler æ”¯æŒå‘½ä»¤è¡Œç®¡ç†ï¼ŒWeb ç•Œé¢ç®¡ç†ï¼Œè¿˜æä¾›äº† API æ¥å£ï¼Œå¯ä»¥æ–¹ä¾¿äºŒæ¬¡å¼€å‘ä½¿ç”¨ã€‚
Cobbler å®¢æˆ·ç«¯ koan æ”¯æŒè™šæ‹Ÿæœºå®‰è£…å’Œæ“ä½œç³»ç»Ÿé‡æ–°å®‰è£…ï¼Œä½¿é‡è£…ç³»ç»Ÿæ›´ä¾¿æ·ã€‚</p>
</blockquote>

<p>å®˜ç½‘ Cobbler ç³»ç»Ÿå¯¹è±¡æ¨¡å‹å›¾<br />
<img src="http://cobbler.github.io/images/how-we-do.png" alt="å®˜ç½‘ Cobbler ç³»ç»Ÿå¯¹è±¡æ¨¡å‹å›¾" /></p>

<p><strong>distro</strong></p>
<ul>
  <li>å‘è¡Œç‰ˆ</li>
  <li>é¢å¯¹ä¸åŒçš„æ“ä½œç³»ç»Ÿ</li>
  <li>é¢å¯¹åŒä¸€ä¸ªæ“ä½œç³»ç»Ÿä¸åŒçš„ç‰ˆæœ¬</li>
</ul>

<p><strong>profile</strong></p>
<ul>
  <li>æ ¸å¿ƒç‰¹æ€§æ˜¯é€šè¿‡ kickstart æ¥éƒ¨ç½²</li>
</ul>

<p><strong>system</strong></p>
<ul>
  <li>ä¸»è¦ç›®çš„é…ç½®ç½‘ç»œæ¥å£</li>
</ul>

<h2 id="2-cobbler-åŠŸèƒ½">2 Cobbler åŠŸèƒ½</h2>

<pre>
ä½¿ç”¨ Cobblerï¼Œæ‚¨æ— éœ€è¿›è¡Œäººå·¥å¹²é¢„å³å¯å®‰è£…æœºå™¨ã€‚Cobbler è®¾ç½®ä¸€ä¸ª PXE å¼•å¯¼ç¯å¢ƒï¼ˆå®ƒè¿˜å¯ä½¿ç”¨ yaboot æ”¯æŒ PowerPCï¼‰ï¼Œ
å¹¶æ§åˆ¶ä¸å®‰è£…ç›¸å…³çš„æ‰€æœ‰æ–¹é¢ï¼Œæ¯”å¦‚ç½‘ç»œå¼•å¯¼æœåŠ¡ï¼ˆDHCP å’Œ TFTPï¼‰ä¸å­˜å‚¨åº“é•œåƒã€‚å½“å¸Œæœ›å®‰è£…ä¸€å°æ–°æœºå™¨æ—¶ï¼ŒCobbler å¯ä»¥ï¼š

ä½¿ç”¨ä¸€ä¸ªä»¥å‰å®šä¹‰çš„æ¨¡æ¿æ¥é…ç½® DHCP æœåŠ¡ï¼ˆå¦‚æœå¯ç”¨äº†ç®¡ç† DHCPï¼‰
å°†ä¸€ä¸ªå­˜å‚¨åº“ï¼ˆyum æˆ– rsyncï¼‰å»ºç«‹é•œåƒæˆ–è§£å‹ç¼©ä¸€ä¸ªåª’ä»‹ï¼Œä»¥æ³¨å†Œä¸€ä¸ªæ–°æ“ä½œç³»ç»Ÿ
åœ¨ DHCP é…ç½®æ–‡ä»¶ä¸­ä¸ºéœ€è¦å®‰è£…çš„æœºå™¨åˆ›å»ºä¸€ä¸ªæ¡ç›®ï¼Œå¹¶ä½¿ç”¨æ‚¨æŒ‡å®šçš„å‚æ•°ï¼ˆIP å’Œ MAC åœ°å€ï¼‰
åœ¨ TFTP æœåŠ¡ç›®å½•ä¸‹åˆ›å»ºé€‚å½“çš„ PXE æ–‡ä»¶
é‡æ–°å¯åŠ¨ DHCP æœåŠ¡ä»¥åæ˜ æ›´æ”¹
é‡æ–°å¯åŠ¨æœºå™¨ä»¥å¼€å§‹å®‰è£…ï¼ˆå¦‚æœç”µæºç®¡ç†å·²å¯ç”¨ï¼‰

   
Cobbler æ”¯æŒä¼—å¤šçš„å‘è¡Œç‰ˆï¼šRed Hatã€Fedoraã€CentOSã€Debianã€Ubuntu å’Œ SuSEã€‚å½“æ·»åŠ ä¸€ä¸ªæ“ä½œç³»ç»Ÿï¼ˆé€šå¸¸é€šè¿‡ä½¿ç”¨ ISO æ–‡ä»¶ï¼‰æ—¶ï¼Œ
Cobbler çŸ¥é“å¦‚ä½•è§£å‹ç¼©åˆé€‚çš„æ–‡ä»¶å¹¶è°ƒæ•´ç½‘ç»œæœåŠ¡ï¼Œä»¥æ­£ç¡®å¼•å¯¼æœºå™¨ã€‚

Cobbler å¯ä½¿ç”¨ kickstart æ¨¡æ¿ã€‚åŸºäº Red Hat æˆ– Fedora çš„ç³»ç»Ÿä½¿ç”¨ kickstart æ–‡ä»¶æ¥è‡ªåŠ¨åŒ–å®‰è£…æµç¨‹ã€‚
é€šè¿‡ä½¿ç”¨æ¨¡æ¿ï¼Œæ‚¨å°±ä¼šæ‹¥æœ‰åŸºæœ¬çš„ kickstart æ¨¡æ¿ï¼Œç„¶åå®šä¹‰å¦‚ä½•é’ˆå¯¹ä¸€ç§é…ç½®æ–‡ä»¶æˆ–æœºå™¨é…ç½®è€Œæ›¿æ¢å…¶ä¸­çš„å˜é‡ã€‚
ä¾‹å¦‚ï¼Œä¸€ä¸ªæ¨¡æ¿å¯èƒ½åŒ…å«ä¸¤ä¸ªå˜é‡ $domain å’Œ $machine_nameã€‚åœ¨ Cobbler é…ç½®ä¸­ï¼Œä¸€ä¸ªé…ç½®æ–‡ä»¶æŒ‡å®š domain=mydomain.comï¼Œ
å¹¶ä¸”æ¯å°ä½¿ç”¨è¯¥é…ç½®æ–‡ä»¶çš„æœºå™¨åœ¨ machine_name å˜é‡ä¸­æŒ‡å®šå…¶åç§°ã€‚è¯¥é…ç½®æ–‡ä»¶ä¸­çš„æ‰€æœ‰æœºå™¨éƒ½ä½¿ç”¨ç›¸åŒçš„ kickstart å®‰è£…ä¸”é’ˆå¯¹ domain=mydomain.com 
è¿›è¡Œé…ç½®ï¼Œä½†æ¯å°æœºå™¨æ‹¥æœ‰å…¶è‡ªå·±çš„æœºå™¨åç§°ã€‚æ‚¨ä»ç„¶å¯ä»¥ä½¿ç”¨ kickstart æ¨¡æ¿åœ¨ä¸åŒçš„åŸŸä¸­å®‰è£…å…¶ä»–æœºå™¨å¹¶ä½¿ç”¨ä¸åŒçš„æœºå™¨åç§°ã€‚

ä¸ºäº†ååŠ©ç®¡ç†ç³»ç»Ÿï¼ŒCobbler å¯é€šè¿‡ fence scripts è¿æ¥åˆ°å„ç§ç”µæºç®¡ç†ç¯å¢ƒã€‚

Cobbler æ”¯æŒ apc_snmpã€bladecenterã€bullpapã€dracã€ether_wakeã€iloã€integrityã€ipmilanã€ipmitoolã€lparã€rsaã€virsh å’Œ wtiã€‚
è¦é‡æ–°å®‰è£…ä¸€å°æœºå™¨ï¼Œå¯è¿è¡Œ reboot system foo å‘½ä»¤ï¼Œè€Œä¸” Cobbler ä¼šä½¿ç”¨å¿…è¦çš„å‡­æ®å’Œä¿¡æ¯æ¥ä¸ºæ‚¨è¿è¡Œæ°å½“çš„ fence scriptsï¼ˆæ¯”å¦‚æœºå™¨æ’æ§½æ•°ï¼‰ã€‚

é™¤äº†è¿™äº›ç‰¹æ€§ï¼Œè¿˜å¯ä½¿ç”¨ä¸€ä¸ªé…ç½®ç®¡ç†ç³»ç»Ÿ (CMS)ã€‚æ‚¨æœ‰ä¸¤ç§é€‰æ‹©ï¼šè¯¥å·¥å…·å†…çš„ä¸€ä¸ªå†…éƒ¨ç³»ç»Ÿï¼Œæˆ–è€…é›†æˆä¸€ä¸ªç°æœ‰çš„å¤–éƒ¨ CMSï¼Œæ¯”å¦‚ Chef æˆ– Puppetã€‚
å€ŸåŠ©å†…éƒ¨ç³»ç»Ÿï¼Œæ‚¨å¯ä»¥æŒ‡å®šæ–‡ä»¶æ¨¡æ¿ï¼Œè¿™äº›æ¨¡æ¿ä¼šä¾æ®é…ç½®å‚æ•°è¿›è¡Œå¤„ç†ï¼ˆä¸ kickstart æ¨¡æ¿çš„å¤„ç†æ–¹å¼ä¸€æ ·ï¼‰ï¼Œç„¶åå¤åˆ¶åˆ°æ‚¨æŒ‡å®šçš„ä½ç½®ã€‚
å¦‚æœå¿…é¡»è‡ªåŠ¨å°†é…ç½®æ–‡ä»¶éƒ¨ç½²åˆ°ç‰¹å®šæœºå™¨ï¼Œé‚£ä¹ˆæ­¤åŠŸèƒ½å¾ˆæœ‰ç”¨ã€‚

ä½¿ç”¨ koan å®¢æˆ·ç«¯ï¼ŒCobbler å¯ä»å®¢æˆ·ç«¯é…ç½®è™šæ‹Ÿæœºå¹¶é‡æ–°å®‰è£…ç³»ç»Ÿã€‚æˆ‘ä¸ä¼šè®¨è®ºé…ç½®ç®¡ç†å’Œ koan ç‰¹æ€§ï¼Œå› ä¸ºå®ƒä»¬ä¸å±äºæœ¬æ–‡çš„ä»‹ç»èŒƒç•´ã€‚
ä½†æ˜¯ï¼Œå®ƒä»¬æ˜¯å€¼å¾—ç ”ç©¶çš„æœ‰ç”¨ç‰¹æ€§ã€‚
</pre>

<h2 id="3-åŸºç¡€ç¯å¢ƒå‡†å¤‡">3 åŸºç¡€ç¯å¢ƒå‡†å¤‡</h2>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@linux-node1 ~]# <span class="nb">cat</span> /etc/redhat-release	<span class="c"># æŸ¥çœ‹ç³»ç»Ÿç‰ˆæœ¬</span>
CentOS Linux release 7.2.1511 <span class="o">(</span>Core<span class="o">)</span>
<span class="o">[</span>root@linux-node1 ~]# <span class="nb">uname</span> <span class="nt">-r</span>		<span class="c"># æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬</span>
3.10.0-327.18.2.el7.x86_64
<span class="o">[</span>root@linux-node1 ~]# getenforce	<span class="c"># ç¡®è®¤ SELinux å…³é—­</span>
Disabled
<span class="o">[</span>root@linux-node1 ~]# systemctl status firewalld	<span class="c"># ç¡®è®¤é˜²ç«å¢™å…³é—­</span>
â— firewalld.service - firewalld - dynamic firewall daemon
   Loaded: loaded <span class="o">(</span>/usr/lib/systemd/system/firewalld.service<span class="p">;</span> disabled<span class="p">;</span> vendor preset: enabled<span class="o">)</span>
   Active: inactive <span class="o">(</span>dead<span class="o">)</span>
<span class="o">[</span>root@linux-node1 ~]# ip a | <span class="nb">grep </span>eth0	<span class="c"># æŸ¥çœ‹ IP åœ°å€</span>
2: eth0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP qlen 1000
    inet 192.168.56.11/24 brd 192.168.56.255 scope global eth0
<span class="o">[</span>root@linux-node1 ~]# <span class="nb">hostname</span>		<span class="c"># æŸ¥çœ‹ä¸»æœºå</span>
linux-node1
<span class="o">[</span>root@linux-node1 ~]# rpm <span class="nt">-ivh</span> http://mirrors.aliyun.com/epel/epel-release-latest-7.noarch.rpm	<span class="c"># å®‰è£… epel æºï¼ˆå› ä¸º Cobbler è½¯ä»¶åŒ…åœ¨æ­¤æºä¸­ï¼‰</span>
Retrieving http://mirrors.aliyun.com/epel/epel-release-latest-7.noarch.rpm
Preparing...                          <span class="c">################################# [100%]</span>
Updating / installing...
   1:epel-release-7-6                 <span class="c">################################# [100%]</span>
</code></pre></div></div>

<blockquote>

  <p>æ³¨æ„ï¼š</p>
  <ul>
    <li>è™šæ‹Ÿæœºç½‘å¡é‡‡ç”¨ NAT æ¨¡å¼å¹¶å…³é—­ï¼Œä¸è¦ä½¿ç”¨æ¡¥æ¥æ¨¡å¼ï¼Œå› ä¸ºæˆ‘ä»¬ä¼šæ­å»º DHCP æœåŠ¡å™¨ï¼Œåœ¨åŒä¸€å±€åŸŸç½‘å¤šä¸ª DHCP æœåŠ¡ä¼šæœ‰å†²çªï¼Œå¹¶ä¸”å¯¼è‡´å®è·µå¤±è´¥ã€‚</li>
    <li>VMware çš„ NAT æ¨¡å¼çš„ DHCP æœåŠ¡ä¹Ÿå…³é—­ï¼Œé¿å…å¹²æ‰°ã€‚</li>
  </ul>
</blockquote>

<h2 id="4-cobbler-å®‰è£…é…ç½®">4 Cobbler å®‰è£…é…ç½®</h2>

<h3 id="41-å®‰è£…-cobbler-åŠç›¸å…³è½¯ä»¶åŒ…">4.1 å®‰è£… Cobbler åŠç›¸å…³è½¯ä»¶åŒ…</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@linux-node1 ~]# yum <span class="nb">install </span>dhcp tftp-server xinetd httpd cobbler cobbler-web pykickstart <span class="nt">-y</span>
<span class="o">[</span>root@linux-node1 ~]# rpm <span class="nt">-qa</span> | <span class="nb">grep</span> <span class="nt">-E</span> <span class="s2">"dhcp|tftp-server|xinetd|httpd|cobbler|cobbler-web|pykickstart"</span>
dhcp-common-4.2.5-42.el7.centos.x86_64	
cobbler-2.6.11-1.el7.x86_64			<span class="c"># Cobbler ç¨‹åºåŒ…</span>
pykickstart-1.99.66.6-1.el7.noarch	<span class="c"># Cobbler æ£€æŸ¥ kickstart è¯­æ³•é”™è¯¯</span>
httpd-tools-2.4.6-40.el7.centos.1.x86_64
dhcp-libs-4.2.5-42.el7.centos.x86_64 
tftp-server-5.2-12.el7.x86_64		<span class="c"># tftp æœåŠ¡</span>
dhcp-4.2.5-42.el7.centos.x86_64		<span class="c"># dchp æœåŠ¡</span>
xinetd-2.3.15-12.el7.x86_64
httpd-2.4.6-40.el7.centos.1.x86_64	<span class="c"># Apache Web æœåŠ¡</span>
cobbler-web-2.6.11-1.el7.noarch		<span class="c"># Cobbler çš„ Web ç¨‹åºåŒ…</span>
<span class="o">[</span>root@linux-node1 ~]# rpm <span class="nt">-ql</span> cobbler	<span class="c">#  æŸ¥çœ‹å®‰è£…çš„æ–‡ä»¶ï¼Œä¸‹é¢åˆ—å‡ºéƒ¨åˆ†</span>
/etc/cobbler                  <span class="c"># é…ç½®æ–‡ä»¶ç›®å½•</span>
/etc/cobbler/settings         <span class="c"># Cobbler ä¸»é…ç½®æ–‡ä»¶ï¼Œè¿™ä¸ªæ–‡ä»¶æ˜¯ YAML æ ¼å¼ï¼ŒCobbler æ˜¯ Python å†™çš„ç¨‹åº</span>
/etc/cobbler/dhcp.template    <span class="c"># DHCP æœåŠ¡çš„é…ç½®æ¨¡æ¿</span>
/etc/cobbler/tftpd.template   <span class="c"># tftp æœåŠ¡çš„é…ç½®æ¨¡æ¿</span>
/etc/cobbler/rsync.template   <span class="c"># rsync æœåŠ¡çš„é…ç½®æ¨¡æ¿</span>
/etc/cobbler/iso              <span class="c"># ISO æ¨¡æ¿é…ç½®æ–‡ä»¶ç›®å½•</span>
/etc/cobbler/pxe              <span class="c"># PXE æ¨¡æ¿æ–‡ä»¶ç›®å½•</span>
/etc/cobbler/power            <span class="c"># ç”µæºçš„é…ç½®æ–‡ä»¶ç›®å½•</span>
/etc/cobbler/users.conf       <span class="c"># Web æœåŠ¡æˆæƒé…ç½®æ–‡ä»¶</span>
/etc/cobbler/users.digest     <span class="c"># ç”¨äº Web è®¿é—®çš„ç”¨æˆ·åå¯†ç é…ç½®æ–‡ä»¶</span>
/etc/cobbler/dnsmasq.template <span class="c"># DNS æœåŠ¡çš„é…ç½®æ¨¡æ¿</span>
/etc/cobbler/modules.conf     <span class="c"># Cobbler æ¨¡å—é…ç½®æ–‡ä»¶</span>
/var/lib/cobbler              <span class="c"># Cobbler æ•°æ®ç›®å½•</span>
/var/lib/cobbler/config       <span class="c"># é…ç½®æ–‡ä»¶</span>
/var/lib/cobbler/kickstarts   <span class="c"># é»˜è®¤å­˜æ”¾ kickstart æ–‡ä»¶ç›®å½•</span>
/var/lib/cobbler/loaders      <span class="c"># å­˜æ”¾çš„å„ç§å¼•å¯¼ç¨‹åº</span>
/var/www/cobbler              <span class="c"># ç³»ç»Ÿå®‰è£…é•œåƒç›®å½•</span>
/var/www/cobbler/ks_mirror    <span class="c"># å¯¼å…¥çš„ç³»ç»Ÿé•œåƒåˆ—è¡¨</span>
/var/www/cobbler/images       <span class="c"># å¯¼å…¥çš„ç³»ç»Ÿé•œåƒå¯åŠ¨æ–‡ä»¶</span>
/var/www/cobbler/repo_mirror  <span class="c"># yum æºå­˜å‚¨ç›®å½•</span>
/var/log/cobbler              <span class="c"># æ—¥å¿—ç›®å½•</span>
/var/log/cobbler/install.log  <span class="c"># å®¢æˆ·ç«¯ç³»ç»Ÿå®‰è£…æ—¥å¿—</span>
/var/log/cobbler/cobbler.log  <span class="c"># Cobbler æ—¥å¿—</span>
</code></pre></div></div>

<h3 id="42-é…ç½®-cobbler">4.2 é…ç½® Cobbler</h3>

<blockquote>

  <p>Cobbler çš„è¿è¡Œä¾èµ–äº DHCPã€TFTPã€RSYNC åŠ DNS æœåŠ¡ï¼Œå…¶ä¸­ DHCP å¯ç”± dhcpdï¼ˆISCï¼‰æä¾›ï¼Œä¹Ÿå¯ç”± dnsmasq æä¾›ï¼›TFTP å¯ç”± tftp-server ç¨‹åºåŒ…æä¾›ï¼Œä¹Ÿå¯ç”± Cobbler åŠŸèƒ½æä¾›ï¼Œ
rsync ç”± rsync ç¨‹åºåŒ…æä¾›ï¼ŒDNS å¯ç”± bind æä¾›ï¼Œä¹Ÿå¯ç”± dnsmasq æä¾›ã€‚<br />
Cobblerå¯è‡ªè¡Œç®¡ç†è¿™äº›æœåŠ¡ä¸­çš„éƒ¨åˆ†ç”šè‡³æ˜¯å…¨éƒ¨ï¼Œä½†éœ€è¦é…ç½®æ–‡ä»¶ /etc/cobbler/settings ä¸­çš„â€œmanange_dhcpâ€ã€â€œmanager_tftpdâ€ã€â€œmanager_rsyncâ€ã€â€œmanager_dnsâ€åˆ†åˆ«æ¥è¿›è¡Œå®šä¹‰ï¼Œ
å¦å¤–ï¼Œç”±äºå„ç§æœåŠ¡éƒ½æœ‰ç€ä¸åŒçš„å®ç°æ–¹å¼ï¼Œå¦‚è‹¥éœ€è¦è¿›è¡Œè‡ªå®šä¹‰ï¼Œéœ€è¦é€šè¿‡ä¿®æ”¹ /etc/cobbler/modules.conf é…ç½®æ–‡ä»¶ä¸­å„æœåŠ¡çš„æ¨¡å—å‚æ•°çš„å€¼æ¥å®ç°ã€‚</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@linux-node1 ~]# systemctl start httpd		<span class="c"># å¯åŠ¨ Apache httpd æœåŠ¡</span>
<span class="o">[</span>root@linux-node1 ~]# systemctl start cobblerd	<span class="c"># å¯åŠ¨ Cobbler æœåŠ¡</span>
<span class="o">[</span>root@linux-node1 ~]# systemctl status httpd cobblerd <span class="c"># æŸ¥çœ‹ Apache httpdã€Cobbler æœåŠ¡çŠ¶æ€</span>

<span class="c"># æ£€æŸ¥é…ç½®æ–‡ä»¶ï¼Œéœ€è¦åœ¨ cobblerd å’Œ httpd å¯åŠ¨çš„æƒ…å†µä¸‹æ£€æŸ¥</span>

<span class="o">[</span>root@linux-node1 ~]# cobbler check
The following are potential configuration items that you may want to fix:

1 : The â€˜serverâ€™ field <span class="k">in</span> /etc/cobbler/settings must be <span class="nb">set </span>to something other than localhost, or kickstarting features will not work.  This should be a resolvable 
<span class="nb">hostname </span>or IP <span class="k">for </span>the boot server as reachable by all machines that will use it.
2 : For PXE to be functional, the â€˜next_serverâ€™ field <span class="k">in</span> /etc/cobbler/settings must be <span class="nb">set </span>to something other than 127.0.0.1, and should match the IP of the boot
server on the PXE network.
3 : change â€˜disableâ€™ to â€˜noâ€™ <span class="k">in</span> /etc/xinetd.d/tftp
4 : some network boot-loaders are missing from /var/lib/cobbler/loaders, you may run â€˜cobbler get-loadersâ€™ to download them, or, <span class="k">if </span>you only want to handle 
x86/x86_64 netbooting, you may ensure that you have installed a <span class="k">*</span>recent<span class="k">*</span> version of the syslinux package installed and can ignore this message entirely.  
Files <span class="k">in </span>this directory, should you want to support all architectures, should include pxelinux.0, menu.c32, elilo.efi, and yaboot. The â€˜cobbler get-loadersâ€™ 
<span class="nb">command </span>is the easiest way to resolve these requirements.
5 : <span class="nb">enable </span>and start rsyncd.service with systemctl
6 : debmirror package is not installed, it will be required to manage debian deployments and repositories
7 : The default password used by the sample templates <span class="k">for </span>newly installed machines <span class="o">(</span>default_password_crypted <span class="k">in</span> /etc/cobbler/settings<span class="o">)</span> is still <span class="nb">set </span>to â€˜cobblerâ€™
and should be changed, try: â€œopenssl passwd <span class="nt">-1</span> <span class="nt">-salt</span> â€˜random-phrase-hereâ€™ â€˜your-password-here<span class="s1">'â€ to generate new one
8 : fencing tools were not found, and are required to use the (optional) power management features. install cman or fence-agents to use them
 
Restart cobblerd and then run â€˜cobbler syncâ€™ to apply changes.

# å¦‚ä¸Šå„é—®é¢˜è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š
# ç¬¬ 1ã€2ã€7 ä¸ªé—®é¢˜ï¼Œé¡ºä¾¿ä¿®æ”¹å…¶ä»–åŠŸèƒ½
[root@linux-node1 ~]# cp /etc/cobbler/settings{,.ori}	# å¤‡ä»½

# ä¿®æ”¹ /etc/cobbler/settings æ–‡ä»¶ä¸­çš„ server å‚æ•°çš„å€¼ä¸ºæä¾› cobbler æœåŠ¡çš„ä¸»æœºç›¸åº”çš„ IP åœ°å€æˆ–ä¸»æœºå
[root@linux-node1 ~]# sed -i "s#server: 127.0.0.1#server: 192.168.56.11#" /etc/cobbler/settings
[root@linux-node1 ~]# grep "^server: " /etc/cobbler/settings
server: 192.168.56.11

# ä¿®æ”¹ /etc/cobbler/settings æ–‡ä»¶ä¸­çš„ next_server å‚æ•°çš„å€¼ä¸ºæä¾› PXE æœåŠ¡çš„ä¸»æœºç›¸åº”çš„ IP åœ°å€
[root@linux-node1 ~]# sed -i "s#next_server: 127.0.0.1#next_server: 192.168.56.11#" /etc/cobbler/settings
[root@linux-node1 ~]# grep "^next_server: " /etc/cobbler/settings
next_server: 192.168.56.11

# é˜²æ­¢å¾ªç¯è£…ç³»ç»Ÿï¼Œé€‚ç”¨äºæœåŠ¡å™¨ç¬¬ä¸€å¯åŠ¨é¡¹æ˜¯ PXE å¯åŠ¨
[root@linux-node1 ~]# sed -i "s#pxe_just_once: 0#pxe_just_once: 1#" /etc/cobbler/settings
[root@linux-node1 ~]# grep "^pxe_just_once: " /etc/cobbler/settings
pxe_just_once: 1

# è®¾ç½®æ–°è£…ç³»ç»Ÿçš„é»˜è®¤ root å¯†ç  cobbler
[root@linux-node1 ~]# openssl passwd -1 -salt '</span>cobbler<span class="s1">' '</span>cobbler<span class="s1">'
$1$cobbler$M6SE55xZodWc9.vAKLJs6.
# ä¿®æ”¹ /etc/cobbler/settings æ–‡ä»¶ä¸­çš„ default_password_crypted å‚æ•°çš„å€¼ä¸ºä¸Šé¢ç”Ÿæˆçš„å¯†ç ä¸²
[root@linux-node1 ~]# vim /etc/cobbler/settings

# ç¬¬ 3 ä¸ªé—®é¢˜ï¼Œä¿®æ”¹ /etc/xinetd.d/tftp æ–‡ä»¶ä¸­çš„ disable å‚æ•°ä¿®æ”¹ä¸º disable = no
[root@linux-node1 ~]# sed -i "/disable/ {s#yes#no#}" /etc/xinetd.d/tftp 
[root@linux-node1 ~]# grep "disable" /etc/xinetd.d/tftp
        disable                 = no

# ç¬¬ 4 ä¸ªé—®é¢˜ï¼Œæ‰§è¡Œ cobbler get-loaders å‘½ä»¤å³å¯ï¼Œä¼šè‡ªåŠ¨ä»å®˜ç½‘ä¸‹è½½
[root@linux-node1 ~]# cobbler get-loaders

# ç¬¬ 5 ä¸ªé—®é¢˜ï¼Œé…ç½® rsyncd å¼€æœºå¯åŠ¨ï¼Œå¯åŠ¨ rsyncd
[root@linux-node1 ~]# systemctl enable rsyncd
[root@linux-node1 ~]# systemctl start xinetd rsyncd
[root@linux-node1 ~]# systemctl status rsyncd

# ç¬¬ 6 ä¸ªé—®é¢˜ï¼Œå’Œ Debian ç³»ç»Ÿç›¸å…³ï¼Œä¸éœ€è¦

# ç¬¬ 8 ä¸ªé—®é¢˜ï¼Œfenceè®¾å¤‡ç›¸å…³ï¼Œæš‚ä¸éœ€è¦

# ä¸Šé¢ç›¸å…³é—®é¢˜é…ç½®å®Œåï¼Œé‡å¯ Cobblerï¼Œå¹¶å†æ¬¡æ‰§è¡Œ cobbler check æ£€æŸ¥ç¡®è®¤ï¼ˆå¦‚ä¸‹ç®—è§£å†³äº†ç›¸å…³é—®é¢˜ï¼‰
[root@linux-node1 ~]# systemctl restart cobblerd
[root@linux-node1 ~]# cobbler check
The following are potential configuration items that you may want to fix:

1 : debmirror package is not installed, it will be required to manage debian deployments and repositories
2 : fencing tools were not found, and are required to use the (optional) power management features. install cman or fence-agents to use them

Restart cobblerd and then run '</span>cobbler <span class="nb">sync</span><span class="s1">' to apply changes.
</span></code></pre></div></div>

<h3 id="43-é…ç½®-dhcp">4.3 é…ç½® DHCP</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># é…ç½®ä½¿ç”¨ Cobbler ç®¡ç† DHCP</span>
<span class="o">[</span>root@linux-node1 ~]# <span class="nb">sed</span> <span class="nt">-i</span> <span class="s2">"s#manage_dhcp: 0#manage_dhcp: 1#"</span> /etc/cobbler/settings
<span class="o">[</span>root@linux-node1 ~]# <span class="nb">grep</span> <span class="s2">"^manage_dhcp: "</span> /etc/cobbler/settings
manage_dhcp: 1
<span class="c"># ä¿®æ”¹ Cobbler çš„ DHCP æ¨¡ç‰ˆï¼Œä¸è¦ç›´æ¥ä¿®æ”¹ DHCP æœ¬èº«çš„é…ç½®æ–‡ä»¶ï¼Œå› ä¸º Cobbler ä¼šè¦†ç›–</span>
<span class="o">[</span>root@linux-node1 ~]# <span class="nb">cp</span> /etc/cobbler/dhcp.template<span class="o">{</span>,.ori<span class="o">}</span>
<span class="o">[</span>root@linux-node1 ~]# vim /etc/cobbler/dhcp.template	<span class="c"># åˆ—å‡ºä¿®æ”¹è¿‡çš„ç›¸å…³å­—æ®µ</span>
...
subnet 192.168.56.0 netmask 255.255.255.0 <span class="o">{</span>
     option routers             192.168.56.2<span class="p">;</span>
     option domain-name-servers 192.168.56.2<span class="p">;</span>
     option subnet-mask         255.255.255.0<span class="p">;</span>
     range dynamic-bootp        192.168.56.100 192.168.56.254<span class="p">;</span>
     default-lease-time         21600<span class="p">;</span>
     max-lease-time             43200<span class="p">;</span>
     next-server                <span class="nv">$next_server</span><span class="p">;</span>
...
</code></pre></div></div>

<h3 id="44-åŒæ­¥-cobbler-é…ç½®">4.4 åŒæ­¥ Cobbler é…ç½®</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># åŒæ­¥æœ€æ–° Cobbler é…ç½®ï¼Œå®ƒä¼šæ ¹æ®é…ç½®è‡ªåŠ¨ä¿®æ”¹ DHCP ç­‰æœåŠ¡</span>

<span class="o">[</span>root@linux-node1 ~]# systemctl restart cobblerd
<span class="o">[</span>root@linux-node1 ~]# cobbler <span class="nb">sync</span>		<span class="c"># åŒæ­¥æ‰€æœ‰é…ç½®ï¼Œå¯ä»¥ä»”ç»†çœ‹ä¸€ä¸‹ sync åšäº†ä»€ä¹ˆ</span>
task started: 2016-05-28_091148_sync
task started <span class="o">(</span><span class="nb">id</span><span class="o">=</span>Sync, <span class="nb">time</span><span class="o">=</span>Sat May 28 09:11:48 2016<span class="o">)</span>
running pre-sync triggers
cleaning trees
removing: /var/www/cobbler/images/CentOS-7-x86_64
removing: /var/lib/tftpboot/pxelinux.cfg/01-00-0c-29-1d-bf-f1
removing: /var/lib/tftpboot/pxelinux.cfg/default
removing: /var/lib/tftpboot/grub/images
removing: /var/lib/tftpboot/grub/grub-x86.efi
removing: /var/lib/tftpboot/grub/grub-x86_64.efi
removing: /var/lib/tftpboot/grub/01-00-0C-29-1D-BF-F1
removing: /var/lib/tftpboot/grub/efidefault
removing: /var/lib/tftpboot/images/CentOS-7-x86_64
removing: /var/lib/tftpboot/s390x/profile_list
copying bootloaders
trying hardlink /var/lib/cobbler/loaders/grub-x86.efi -&gt; /var/lib/tftpboot/grub/grub-x86.efi
trying hardlink /var/lib/cobbler/loaders/grub-x86_64.efi -&gt; /var/lib/tftpboot/grub/grub-x86_64.efi
copying distros to tftpboot
copying files <span class="k">for </span>distro: CentOS-7-x86_64
trying hardlink /var/www/cobbler/ks_mirror/CentOS-7-x86_64/images/pxeboot/vmlinuz -&gt; /var/lib/tftpboot/images/CentOS-7-x86_64/vmlinuz
trying hardlink /var/www/cobbler/ks_mirror/CentOS-7-x86_64/images/pxeboot/initrd.img -&gt; /var/lib/tftpboot/images/CentOS-7-x86_64/initrd.img
copying images
generating PXE configuration files
generating: /var/lib/tftpboot/pxelinux.cfg/01-00-0c-29-1d-bf-f1
generating: /var/lib/tftpboot/grub/01-00-0C-29-1D-BF-F1
generating PXE menu structure
copying files <span class="k">for </span>distro: CentOS-7-x86_64
trying hardlink /var/www/cobbler/ks_mirror/CentOS-7-x86_64/images/pxeboot/vmlinuz -&gt; /var/www/cobbler/images/CentOS-7-x86_64/vmlinuz
trying hardlink /var/www/cobbler/ks_mirror/CentOS-7-x86_64/images/pxeboot/initrd.img -&gt; /var/www/cobbler/images/CentOS-7-x86_64/initrd.img
Writing template files <span class="k">for </span>CentOS-7-x86_64
rendering DHCP files
generating /etc/dhcp/dhcpd.conf
rendering TFTPD files
generating /etc/xinetd.d/tftp
processing boot_files <span class="k">for </span>distro: CentOS-7-x86_64
cleaning <span class="nb">link </span>caches
running post-sync triggers
running python triggers from /var/lib/cobbler/triggers/sync/post/<span class="k">*</span>
running python trigger cobbler.modules.sync_post_restart_services
running: dhcpd <span class="nt">-t</span> <span class="nt">-q</span>
received on stdout: 
received on stderr: 
running: service dhcpd restart
received on stdout: 
received on stderr: Redirecting to /bin/systemctl restart  dhcpd.service

running shell triggers from /var/lib/cobbler/triggers/sync/post/<span class="k">*</span>
running python triggers from /var/lib/cobbler/triggers/change/<span class="k">*</span>
running python trigger cobbler.modules.scm_track
running shell triggers from /var/lib/cobbler/triggers/change/<span class="k">*</span>
<span class="k">***</span> TASK COMPLETE <span class="k">***</span>

<span class="o">[</span>root@linux-node1 ~]# <span class="nb">head</span> <span class="nt">-7</span> /etc/dhcp/dhcpd.conf 		<span class="c"># å†çœ‹ä¸€ä¸‹ DHCP çš„é…ç½®æ–‡ä»¶</span>
<span class="c"># ******************************************************************</span>
<span class="c"># Cobbler managed dhcpd.conf file</span>
<span class="c"># generated from cobbler dhcp.conf template (Sat May 28 01:11:49 2016)</span>
<span class="c"># Do NOT make changes to /etc/dhcpd.conf. Instead, make your changes</span>
<span class="c"># in /etc/cobbler/dhcp.template, as /etc/dhcpd.conf will be</span>
<span class="c"># overwritten.</span>
<span class="c"># ******************************************************************</span>
</code></pre></div></div>

<h3 id="45-é…ç½®å¼€æœºå¯åŠ¨">4.5 é…ç½®å¼€æœºå¯åŠ¨</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@linux-node1 ~]# systemctl <span class="nb">enable </span>dhcpd xinetd httpd cobblerd
<span class="o">[</span>root@linux-node1 ~]# systemctl is-enabled dhcpd xinetd httpd cobblerd
enabled
enabled
enabled
enabled
</code></pre></div></div>

<h2 id="5-cobbler-å‘½ä»¤è¡Œç®¡ç†">5 Cobbler å‘½ä»¤è¡Œç®¡ç†</h2>

<h3 id="51-æŸ¥çœ‹å‘½ä»¤å¸®åŠ©">5.1 æŸ¥çœ‹å‘½ä»¤å¸®åŠ©</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@linux-node1 ~]# cobbler
usage
<span class="o">=====</span>
cobbler &lt;distro|profile|system|repo|image|mgmtclass|package|file&gt; ... 
        <span class="o">[</span>add|edit|copy|getks<span class="k">*</span>|list|remove|rename|report] <span class="o">[</span>options|--help]
cobbler &lt;aclsetup|buildiso|import|list|replicate|report|reposync|sync|validateks|version|signature|get-loaders|hardlink&gt; <span class="o">[</span>options|--help]

<span class="o">[</span>root@linux-node1 ~]# cobbler import <span class="nt">--help</span>		<span class="c"># å¯¼å…¥é•œåƒå¸®åŠ©</span>
Usage: cobbler <span class="o">[</span>options]

Options:
  <span class="nt">-h</span>, <span class="nt">--help</span>            show this <span class="nb">help </span>message and <span class="nb">exit</span>
  <span class="nt">--arch</span><span class="o">=</span>ARCH           OS architecture being imported
  <span class="nt">--breed</span><span class="o">=</span>BREED         the breed being imported
  <span class="nt">--os-version</span><span class="o">=</span>OS_VERSION
                        the version being imported
  <span class="nt">--path</span><span class="o">=</span>PATH           <span class="nb">local </span>path or rsync location
  <span class="nt">--name</span><span class="o">=</span>NAME           name, ex <span class="s1">'RHEL-5'</span>
  <span class="nt">--available-as</span><span class="o">=</span>AVAILABLE_AS
                        tree is here, don<span class="s1">'t mirror
  --kickstart=KICKSTART_FILE
                        assign this kickstart file
  --rsync-flags=RSYNC_FLAGS
                        pass additional flags to rsync


cobbler check    æ ¸å¯¹å½“å‰è®¾ç½®æ˜¯å¦æœ‰é—®é¢˜
cobbler list     åˆ—å‡ºæ‰€æœ‰çš„ cobbler å…ƒç´ 
cobbler report   åˆ—å‡ºå…ƒç´ çš„è¯¦ç»†ä¿¡æ¯
cobbler sync     åŒæ­¥é…ç½®åˆ°æ•°æ®ç›®å½•ï¼Œæ›´æ”¹é…ç½®æœ€å¥½éƒ½è¦æ‰§è¡Œä¸‹
cobbler reposync åŒæ­¥ yum ä»“åº“
cobbler distro   æŸ¥çœ‹å¯¼å…¥çš„å‘è¡Œç‰ˆç³»ç»Ÿä¿¡æ¯
cobbler profile  æŸ¥çœ‹é…ç½®ä¿¡æ¯
cobbler system   æŸ¥çœ‹æ·»åŠ çš„ç³»ç»Ÿä¿¡æ¯
</span></code></pre></div></div>

<h3 id="52-ç®¡ç†-distro">5.2 ç®¡ç† distro</h3>

<blockquote>

  <p>Cobbler å˜å¾—å¯ç”¨çš„ç¬¬ä¸€æ­¥ä¸ºå®šä¹‰ distroï¼Œå…¶å¯ä»¥é€šè¿‡ä¸ºå…¶æŒ‡å®šå¤–éƒ¨çš„å®‰è£…å¼•å¯¼å†…æ ¸åŠ ramdisk æ–‡ä»¶çš„æ–¹å¼å®ç°ã€‚</p>
</blockquote>

<p>å¦‚æœå·²ç»æœ‰å®Œæˆçš„å®‰è£…æ ‘ï¼ˆå¦‚ OS çš„å®‰è£…é•œåƒï¼‰åˆ™æ¨èä½¿ç”¨ improt å¯¼å…¥çš„æ–¹å¼è¿›è¡Œã€‚</p>

<p>å¯¼å…¥é•œåƒ</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@linux-node1 ~]# mount /dev/cdrom /mnt		 <span class="c"># æŒ‚è½½ CentOS 7 çš„ç³»ç»Ÿé•œåƒ</span>
mount: /dev/sr0 is write-protected, mounting read-only
<span class="o">[</span>root@linux-node1 ~]# cobbler import <span class="nt">--path</span><span class="o">=</span>/mnt/ <span class="nt">--name</span><span class="o">=</span>CentOS-7-x86_64 <span class="nt">--arch</span><span class="o">=</span>x86_64
<span class="c"># --path é•œåƒè·¯å¾„</span>
<span class="c"># --name ä¸ºå®‰è£…æºå®šä¹‰ä¸€ä¸ªåå­—</span>
<span class="c"># --arch æŒ‡å®šå®‰è£…æºæ˜¯ 32 ä½ã€64 ä½ã€ia64, ç›®å‰æ”¯æŒçš„é€‰é¡¹æœ‰: x86â”‚x86_64â”‚ia64</span>
<span class="c"># å®‰è£…æºçš„å”¯ä¸€æ ‡ç¤ºå°±æ˜¯æ ¹æ® name å‚æ•°æ¥å®šä¹‰ï¼Œæœ¬ä¾‹å¯¼å…¥æˆåŠŸåï¼Œå®‰è£…æºçš„å”¯ä¸€æ ‡ç¤ºå°±æ˜¯ï¼šCentOS-7-x86_64ï¼Œå¦‚æœé‡å¤ï¼Œç³»ç»Ÿä¼šæç¤ºå¯¼å…¥å¤±è´¥</span>
<span class="o">[</span>root@linux-node1 ~]# cobbler distro list		<span class="c"># æŸ¥çœ‹é•œåƒåˆ—è¡¨</span>
   CentOS-7-x86_64
<span class="c"># é•œåƒå­˜æ”¾ç›®å½•ï¼ŒCobbler ä¼šå°†é•œåƒä¸­çš„æ‰€æœ‰å®‰è£…æ–‡ä»¶æ‹·è´åˆ°æœ¬åœ°ä¸€ä»½ï¼Œæ”¾åœ¨ /var/www/cobbler/ks_mirror ä¸‹çš„ CentOS-7-x86_64ç›®å½•ä¸‹ã€‚</span>
<span class="c"># å› æ­¤ /var/www/cobbler ç›®å½•å¿…é¡»å…·æœ‰è¶³å¤Ÿå®¹çº³å®‰è£…æ–‡ä»¶çš„ç©ºé—´ã€‚</span>
<span class="o">[</span>root@linux-node1 ~]# ll /var/www/cobbler/ks_mirror/
total 4
dr-xr-xr-x 8 root root 4096 Dec 10 07:14 CentOS-7-x86_64
drwxr-xr-x 2 root root   35 May 25 04:27 config
<span class="o">[</span>root@linux-node1 ~]# cobbler profile list		<span class="c"># å¯¼å…¥ distro ä¼šè‡ªåŠ¨ç”Ÿæˆ profile</span>
</code></pre></div></div>

<blockquote>

  <p>å¦‚æœæœ‰ kickstart æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨â€“kickstart=/path/to/kickstart_file è¿›è¡Œå¯¼å…¥ï¼Œimport ä¼šè‡ªåŠ¨ä¸ºå¯¼å…¥çš„ distro ç”Ÿæˆä¸€ä¸ª profile</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># æŸ¥çœ‹å®‰è£…é•œåƒæ–‡ä»¶ä¿¡æ¯</span>
<span class="o">[</span>root@linux-node1 ~]# cobbler distro report <span class="nt">--name</span><span class="o">=</span>CentOS-7-x86_64
Name                           : CentOS-7-x86_64
Architecture                   : x86_64
TFTP Boot Files                : <span class="o">{}</span>
Breed                          : redhat
Comment                        : 
Fetchable Files                : <span class="o">{}</span>
Initrd                         : /var/www/cobbler/ks_mirror/CentOS-7-x86_64/images/pxeboot/initrd.img
Kernel                         : /var/www/cobbler/ks_mirror/CentOS-7-x86_64/images/pxeboot/vmlinuz
Kernel Options                 : <span class="o">{}</span>
Kernel Options <span class="o">(</span>Post Install<span class="o">)</span>  : <span class="o">{}</span>
Kickstart Metadata             : <span class="o">{</span><span class="s1">'tree'</span>: <span class="s1">'http://@@http_server@@/cblr/links/CentOS-7-x86_64'</span><span class="o">}</span>
Management Classes             : <span class="o">[]</span>
OS Version                     : rhel7
Owners                         : <span class="o">[</span><span class="s1">'admin'</span><span class="o">]</span>
Red Hat Management Key         : <span class="o">&lt;&lt;</span><span class="no">inherit</span><span class="sh">&gt;&gt;
Red Hat Management Server      : &lt;&lt;inherit&gt;&gt;
Template Files                 : {}
</span></code></pre></div></div>

<h3 id="53-ç®¡ç†-profile">5.3 ç®¡ç† profile</h3>

<blockquote>

  <p>Cobblerä½¿ç”¨ profile æ¥ä¸ºç‰¹å®šçš„éœ€æ±‚ç±»åˆ«æä¾›æ‰€éœ€è¦å®‰è£…çš„é…ç½®ï¼Œå³åœ¨ distro çš„åŸºç¡€ä¸Šé€šè¿‡æä¾› kiskstart æ–‡ä»¶æ¥ç”Ÿæˆä¸€ä¸ªç‰¹å®šçš„ç³»ç»Ÿå®‰è£…é…ç½®ã€‚
distro çš„ profile å¯ä»¥å‡ºç°åœ¨ PXE çš„å¼•å¯¼èœå•ä¸­ä½œä¸ºå®‰è£…çš„é€‰æ‹©ä¹‹ä¸€</p>
</blockquote>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># æŸ¥çœ‹æ‰€æœ‰çš„ profile è®¾ç½®</span>
<span class="o">[</span>root@linux-node1 ~]# cobbler profile report

<span class="c"># æŸ¥çœ‹æŒ‡å®šçš„ profile è®¾ç½®</span>
<span class="o">[</span>root@linux-node1 ~]# cobbler profile report <span class="nt">--name</span><span class="o">=</span>CentOS-7-x86_64
<span class="o">[</span>root@linux-node1 ~]# cobbler profile report <span class="nt">--name</span><span class="o">=</span>CentOS-7-x86_64
Name                           : CentOS-7-x86_64
TFTP Boot Files                : <span class="o">{}</span>
Comment                        : 
DHCP Tag                       : default
Distribution                   : CentOS-7-x86_64
Enable gPXE?                   : 0
Enable PXE Menu?               : 1
Fetchable Files                : <span class="o">{}</span>
Kernel Options                 : <span class="o">{</span><span class="s1">'biosdevname'</span>: <span class="s1">'0'</span>, <span class="s1">'net.ifnames'</span>: <span class="s1">'0'</span><span class="o">}</span>
Kernel Options <span class="o">(</span>Post Install<span class="o">)</span>  : <span class="o">{}</span>
Kickstart                      : /var/lib/cobbler/kickstarts/sample_end.ks  <span class="c"># é»˜è®¤ ks æ–‡ä»¶</span>
Kickstart Metadata             : <span class="o">{}</span>
Management Classes             : <span class="o">[]</span>
Management Parameters          : <span class="o">&lt;&lt;</span><span class="no">inherit</span><span class="sh">&gt;&gt;
Name Servers                   : []
Name Servers Search Path       : []
Owners                         : ['admin']
Parent Profile                 : 
Internal proxy                 : 
Red Hat Management Key         : &lt;&lt;inherit&gt;&gt;
Red Hat Management Server      : &lt;&lt;inherit&gt;&gt;
Repos                          : []
Server Override                : &lt;&lt;inherit&gt;&gt;
Template Files                 : {}
Virt Auto Boot                 : 1
Virt Bridge                    : xenbr0
Virt CPUs                      : 1
Virt Disk Driver Type          : raw
Virt File Size(GB)             : 5
Virt Path                      : 
Virt RAM (MB)                  : 512
Virt Type                      : kvm

# Cobbler çš„ ks.cfg æ–‡ä»¶å­˜æ”¾ä½ç½®
[root@linux-node1 ~]# ls /var/lib/cobbler/kickstarts/
CentOS-7-x86_64.cfg  esxi4-ks.cfg  install_profiles  pxerescue.ks         sample_end.ksï¼ˆé»˜è®¤ä½¿ç”¨çš„ksæ–‡ä»¶ï¼‰    sample_esxi4.ks  sample.ks        sample.seed
default.ks           esxi5-ks.cfg  legacy.ks         sample_autoyast.xml  sample_esx4.ks  sample_esxi5.ks  sample_old.seed
# åœ¨ç¬¬ä¸€æ¬¡å¯¼å…¥ç³»ç»Ÿé•œåƒåï¼ŒCobbler ä¼šç»™é•œåƒæŒ‡å®šä¸€ä¸ªé»˜è®¤çš„ kickstart è‡ªåŠ¨å®‰è£…æ–‡ä»¶åœ¨ /var/lib/cobbler/kickstarts ä¸‹çš„ sample_end.ks

[root@linux-node1 ~]# cd /var/lib/cobbler/kickstarts/
[root@linux-node1 kickstarts]# rz		# ä¸Šä¼ å‡†å¤‡å¥½çš„ ks æ–‡ä»¶

# ç¼–è¾‘ profileï¼Œä¿®æ”¹å…³è”çš„ ks æ–‡ä»¶
[root@linux-node1 kickstarts]# cobbler profile edit --name=CentOS-7-x86_64 --kickstart=/var/lib/cobbler/kickstarts/CentOS-7-x86_64.cfg

# ä¿®æ”¹å®‰è£…ç³»ç»Ÿçš„å†…æ ¸å‚æ•°ï¼Œåœ¨ CentOS 7 ç³»ç»Ÿæœ‰ä¸€ä¸ªåœ°æ–¹å˜äº†ï¼Œå°±æ˜¯ç½‘å¡åå˜æˆ eno16777736 è¿™ç§å½¢å¼ï¼Œä½†æ˜¯ä¸ºäº†è¿ç»´æ ‡å‡†åŒ–ï¼Œ
# æˆ‘ä»¬éœ€è¦å°†å®ƒå˜æˆæˆ‘ä»¬å¸¸ç”¨çš„ eth0ï¼Œå› æ­¤ä½¿ç”¨ä¸‹é¢çš„å‚æ•°ã€‚ä½†è¦æ³¨æ„æ˜¯ CentOS 7 æ‰éœ€è¦ä¸‹é¢çš„æ­¥éª¤ï¼ŒCentOS 6 ä¸éœ€è¦ã€‚
[root@linux-node1 kickstarts]# cobbler profile edit --name=CentOS-7-x86_64 --kopts='net.ifnames=0 biosdevname=0'
[root@linux-node1 kickstarts]# cobbler profile report CentOS-7-x86_64
Name                           : CentOS-7-x86_64
TFTP Boot Files                : {}
Comment                        : 
DHCP Tag                       : default
Distribution                   : CentOS-7-x86_64
Enable gPXE?                   : 0
Enable PXE Menu?               : 1
Fetchable Files                : {}
Kernel Options                 : {'biosdevname': '0', 'net.ifnames': '0'}
Kernel Options (Post Install)  : {}
Kickstart                      : /var/lib/cobbler/kickstarts/CentOS-7-x86_64.cfg
Kickstart Metadata             : {}
Management Classes             : []
Management Parameters          : &lt;&lt;inherit&gt;&gt;
Name Servers                   : []
Name Servers Search Path       : []
Owners                         : ['admin']
Parent Profile                 : 
Internal proxy                 : 
Red Hat Management Key         : &lt;&lt;inherit&gt;&gt;
Red Hat Management Server      : &lt;&lt;inherit&gt;&gt;
Repos                          : []
Server Override                : &lt;&lt;inherit&gt;&gt;
Template Files                 : {}
Virt Auto Boot                 : 1
Virt Bridge                    : xenbr0
Virt CPUs                      : 1
Virt Disk Driver Type          : raw
Virt File Size(GB)             : 5
Virt Path                      : 
Virt RAM (MB)                  : 512
Virt Type                      : kvm

# æ¯æ¬¡ä¿®æ”¹å®Œéƒ½è¦åŒæ­¥ä¸€æ¬¡
[root@linux-node1 ~]# cobbler sync
</span></code></pre></div></div>

<h3 id="54-ç®¡ç†-repo">5.4 ç®¡ç† repo</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># æ–°éƒ¨ç½²æœºå™¨å®‰è£… yum æºï¼Œå¹¶åŒæ­¥ã€‚å»ºè®®ä½¿ç”¨å†…ç½‘ yum æºï¼Œåœ¨è¿™é‡Œä½¿ç”¨é˜¿é‡Œäº‘ yum æº</span>
<span class="c"># 1. æ·»åŠ  repo</span>
cobbler repo add <span class="nt">--name</span><span class="o">=</span>centos-7.2-openstack-mitaka <span class="nt">--mirror</span><span class="o">=</span>http://mirrors.aliyun.com/centos/7.2.1511/cloud/x86_64/openstack-mitaka/ <span class="nt">--arch</span><span class="o">=</span>x86_64 <span class="nt">--breed</span><span class="o">=</span>yum
<span class="c"># 2. åŒæ­¥repo</span>
cobbler reposync 
<span class="c"># 3. æ·»åŠ  repo åˆ°å¯¹åº”çš„ profile</span>
cobbler profile edit <span class="nt">--name</span><span class="o">=</span>Centos-7-x86_64  <span class="nt">--repos</span><span class="o">=</span><span class="s2">"centos-7.2-openstack-mitaka"</span>
<span class="c"># 4. ä¿®æ”¹ kickstartæ–‡ä»¶ã€‚æ·»åŠ  $yum_config_stanza åˆ° %post %end ä¸­é—´ï¼Œå¦‚ä¸‹ï¼š</span>
%post
<span class="nv">$yum_config_stanza</span>
%end
<span class="c"># 5. æ·»åŠ å®šæ—¶ä»»åŠ¡ï¼Œå®šæœŸåŒæ­¥ repo</span>
<span class="nb">echo</span> <span class="s2">"0 3 * * * /usr/bin/cobbler reposync --tries=3 --no-fail"</span> <span class="o">&gt;&gt;</span> /var/spool/cron/root

<span class="c"># é‡è£…ç³»ç»Ÿå®Œæˆåçš„æœºå™¨é…ç½®çš„ cobbler repo å¦‚ä¸‹ï¼š</span>
<span class="o">[</span>root@localhost ~]# <span class="nb">cat</span> /etc/yum.repos.d/cobbler-config.repo 
<span class="o">[</span>core-0]
<span class="nv">name</span><span class="o">=</span>core-0
<span class="nv">baseurl</span><span class="o">=</span>http://192.168.56.11/cobbler/ks_mirror/CentOS-7-x86_64
<span class="nv">enabled</span><span class="o">=</span>1
<span class="nv">gpgcheck</span><span class="o">=</span>0
<span class="nv">priority</span><span class="o">=</span>1


<span class="o">[</span>centos-7.2-openstack-mitaka]
<span class="nv">name</span><span class="o">=</span>centos-7.2-openstack-mitaka
<span class="nv">baseurl</span><span class="o">=</span>http://192.168.56.11/cobbler/repo_mirror/centos-7.2-openstack-mitaka
<span class="nv">enabled</span><span class="o">=</span>1
<span class="nv">priority</span><span class="o">=</span>99
<span class="nv">gpgcheck</span><span class="o">=</span>0
</code></pre></div></div>

<h2 id="6-å®‰è£…ç³»ç»Ÿ">6 å®‰è£…ç³»ç»Ÿ</h2>

<h3 id="61-å®‰è£…æ–°ç³»ç»Ÿ">6.1 å®‰è£…æ–°ç³»ç»Ÿ</h3>

<p>æ–°å»ºä¸€å°è™šæ‹Ÿæœºï¼Œé€šè¿‡ç½‘ç»œå¯åŠ¨å³å¯ã€‚</p>

<p><img src="https://raw.githubusercontent.com/JaminZhang/jaminzhang.github.io/master/images/Cobbler/Cobbler-PXE-Menu-01.png" alt="Cobbler-PXE-Menu-01.png" /></p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># ä¿®æ”¹ Cobbler æç¤º</span>
<span class="o">[</span>root@linux-node1 ~]# vim /etc/cobbler/pxe/pxedefault.template	<span class="c"># ä¿®æ”¹æˆè‡ªå®šä¹‰</span>
MENU TITLE Cobbler | http://jaminzhang.github.io
<span class="o">[</span>root@linux-node1 ~]# cobbler <span class="nb">sync</span> <span class="c"># ä¿®æ”¹é…ç½®éƒ½è¦åŒæ­¥</span>
</code></pre></div></div>

<p>é€‰æ‹©ç¬¬äºŒé¡¹å°±å¯ä»¥ç»§ç»­å®‰è£…ç³»ç»Ÿäº†ã€‚</p>

<p><img src="https://raw.githubusercontent.com/JaminZhang/jaminzhang.github.io/master/images/Cobbler/Cobbler-PXE-Menu-02.png" alt="Cobbler-PXE-Menu-02.png" /></p>

<p>ks.cfg æ¨¡æ¿æ–‡ä»¶: <a href="http://jaminzhang.github.io/soft-conf/Cobbler/Cobbler-CentOS-7.2-x86_64.cfg">Cobbler-CentOS-7.2-x86_64.cfg</a></p>

<h3 id="62-ä½¿ç”¨-koan-å®¢æˆ·ç«¯è¿›è¡Œç³»ç»Ÿé‡è£…">6.2 ä½¿ç”¨ koan å®¢æˆ·ç«¯è¿›è¡Œç³»ç»Ÿé‡è£…</h3>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c"># å®‰è£… koan å®¢æˆ·ç«¯</span>
<span class="o">[</span>root@linux-node1 ~]# yum <span class="nb">install </span>koan <span class="nt">-y</span>
<span class="c"># æŸ¥è¯¢ Cobbler æœåŠ¡å™¨ä¸Š profile</span>
<span class="o">[</span>root@linux-node1 ~]# koan <span class="nt">--server</span><span class="o">=</span>192.168.56.11 <span class="nt">--list</span><span class="o">=</span>profiles
- looking <span class="k">for </span>Cobbler at http://192.168.56.11:80/cobbler_api
CentOS-7-x86_64
CentOS-6-x86_64
<span class="c"># æŒ‡å®šè¦é‡è£…çš„ç³»ç»Ÿ</span>
<span class="o">[</span>root@linux-node1 ~]# koan <span class="nt">--replace-self</span> <span class="nt">--server</span><span class="o">=</span>192.168.56.11 <span class="nt">--profile</span><span class="o">=</span>CentOS-6-x86_64
</code></pre></div></div>

<blockquote>

  <p>å¦‚ä½•é¿å… koan å®‰è£…é”™è¯¯æœºå™¨ï¼Œæˆ–è€… cobbler è‡ªåŠ¨åŒ–å®‰è£…é”™è¯¯æœºå™¨ã€‚<br />
è§£å†³æ–¹æ³•ï¼šç¯å¢ƒè®¾è®¡ï¼šé…ç½®è£…æœº VLAN</p>
</blockquote>

<h3 id="63-å®šåˆ¶åŒ–å®‰è£…">6.3 å®šåˆ¶åŒ–å®‰è£…</h3>

<p>å¯èƒ½ä»å­¦ä¹  kickstart å¼€å§‹å°±æœ‰äººæƒ³æ€æ ·èƒ½å¤ŸæŒ‡å®šæŸå°æœåŠ¡å™¨ä½¿ç”¨æŒ‡å®š ks æ–‡ä»¶ï¼Œkickstart å®ç°è¿™åŠŸèƒ½å¯èƒ½æ¯”è¾ƒå¤æ‚ï¼Œä½†æ˜¯ Cobbler å°±å¾ˆç®€å•äº†ã€‚
åŒºåˆ†ä¸€å°æœåŠ¡å™¨çš„æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯ç‰©ç†MACåœ°å€ã€‚<br />
ç‰©ç†æœåŠ¡å™¨çš„ MAC åœ°å€åœ¨æœåŠ¡å™¨ä¸Šçš„æ ‡ç­¾ä¸Šå†™äº†ã€‚</p>

<p>æ ¹æ®æœºå™¨çš„ MAC åœ°å€ï¼Œè‡ªåŠ¨ç»‘å®š IPï¼Œç½‘å…³ï¼ŒDNS ç­‰</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@linux-node1 ~]# cobbler system add <span class="nt">--name</span><span class="o">=</span>jaminzhang.github.io <span class="nt">--mac</span><span class="o">=</span>00:50:56:35:46:6E <span class="nt">--profile</span><span class="o">=</span>CentOS-7-x86_64 <span class="nt">--ip-address</span><span class="o">=</span>192.168.56.118 <span class="nt">--subnet</span><span class="o">=</span>255.255.255.0 <span class="nt">--gateway</span><span class="o">=</span>192.168.56.2 <span class="se">\</span>
<span class="nt">--interface</span><span class="o">=</span>eth0 <span class="nt">--static</span><span class="o">=</span>1 <span class="nt">--hostname</span><span class="o">=</span>jaminzhang.github.io <span class="nt">--name-servers</span><span class="o">=</span><span class="s2">"223.5.5.5 223.6.6.6"</span> <span class="nt">--kickstart</span><span class="o">=</span>/var/lib/cobbler/kickstarts/CentOS-7-x86_64.cfg

<span class="c"># --name è‡ªå®šä¹‰ï¼Œä½†ä¸èƒ½é‡å¤</span>
<span class="c"># æŸ¥çœ‹å®šä¹‰çš„åˆ—è¡¨c</span>
<span class="o">[</span>root@linux-node1 ~]# cobbler system list
   jaminzhang.github.io

<span class="o">[</span>root@linux-node1 ~]# cobbler <span class="nb">sync</span>
</code></pre></div></div>

<p>ä¸è¿›è¡Œè¯¢é—®,è‡ªåŠ¨å®‰è£…<br />
<img src="https://raw.githubusercontent.com/JaminZhang/jaminzhang.github.io/master/images/Cobbler/Cobbler-PXE-Custom-01.png" alt="Cobbler-PXE-Custom-01.png" /></p>

<p>ç™»é™†ç³»ç»Ÿæ£€æŸ¥ç›¸å…³ä¿¡æ¯<br />
<img src="https://raw.githubusercontent.com/JaminZhang/jaminzhang.github.io/master/images/Cobbler/Cobbler-PXE-Custom-02.png" alt="Cobbler-PXE-Custom-02.png" /></p>

<h3 id="64-æœåŠ¡å™¨é‡‡è´­åŠç³»ç»Ÿå®‰è£…æµç¨‹">6.4 æœåŠ¡å™¨é‡‡è´­åŠç³»ç»Ÿå®‰è£…æµç¨‹</h3>

<ol>
  <li>æœåŠ¡å™¨é‡‡è´­</li>
  <li>æœåŠ¡å™¨éªŒæ”¶å¹¶è®¾ç½® RAID</li>
  <li>æœåŠ¡å•†æä¾›éªŒæ”¶å•ï¼Œè¿ç»´éªŒæ”¶è´Ÿè´£äººç­¾å­—ã€‚</li>
  <li>æœåŠ¡å™¨ä¸Šæ¶</li>
  <li>èµ„äº§å½•å…¥ã€‚</li>
  <li>å¼€å§‹è‡ªåŠ¨åŒ–å®‰è£…ã€‚
    <ol>
      <li>å°†æ–°æœåŠ¡å™¨åˆ’å…¥è£…æœº VLAN</li>
      <li>
        <p>æ ¹æ®èµ„äº§æ¸…å•ä¸Šçš„ MAC åœ°å€ï¼Œè‡ªå®šä¹‰å®‰è£…ã€‚
 1.æœºæˆ¿ 2. æœºæˆ¿åŒºåŸŸ 3. æœºæŸœ  4. æœåŠ¡å™¨ä½ç½®  5. æœåŠ¡å™¨ç½‘çº¿æ¥å…¥ç«¯å£  6. è¯¥ç«¯å£ MAC åœ°å€    	
 7.profile ks.cfg ä¸­æŒ‡å®šæ“ä½œç³»ç»Ÿ åˆ†åŒºç­‰ã€é¢„åˆ†é…çš„ IP åœ°å€ã€ä¸»æœºåã€å­ç½‘ã€ç½‘å…³ã€DNSã€è§’è‰²ç­‰ã€‚</p>
      </li>
      <li>è‡ªåŠ¨åŒ–è£…æœºå¹³å°ï¼Œå®‰è£…ã€‚
 ä¾‹å­ï¼š<br />
 MAC: 00:50:56:35:46:6E<br />
 IP: 192.168.56.118<br />
 æ©ç ï¼š255.255.255.0 <br />
 ç½‘å…³ï¼š192.168.56.2 <br />
 ä¸»æœºåï¼šjaminzhang.github.io <br />
 DNSï¼š223.5.5.5 223.6.6.6<br />
 æ ¹æ® 6.3 ä¸­çš„å®šåˆ¶åŒ–å®‰è£…é…ç½®å¦‚ä¸‹ system:<br />
 cobbler system add â€“name=jaminzhang.github.io â€“mac=00:50:56:35:46:6E â€“profile=CentOS-7-x86_64 â€“ip-address=192.168.56.118 â€“subnet=255.255.255.0 â€“gateway=192.168.56.2 \<br />
â€“interface=eth0 â€“static=1 â€“hostname=jaminzhang.github.io â€“name-servers=â€223.5.5.5 223.6.6.6â€ â€“kickstart=/var/lib/cobbler/kickstarts/CentOS-7-x86_64.cfg</li>
    </ol>
  </li>
</ol>

<h2 id="7-cobbler-web-ç®¡ç†é…ç½®">7 Cobbler Web ç®¡ç†é…ç½®</h2>

<p>æ–°ç‰ˆ Cobbler çš„ Web ç•Œé¢ä½¿ç”¨çš„æ˜¯ https<br />
ç™»å½•URL: https://192.168.56.11/cobbler_web</p>

<h3 id="71-é…ç½®è´¦å·å¯†ç ">7.1 é…ç½®è´¦å·å¯†ç </h3>
<p>cobbler_web æ”¯æŒå¤šç§è®¤è¯æ–¹å¼ï¼Œå¦‚ authn_configfileã€authn_ldap æˆ– authn_pam ç­‰ï¼Œé»˜è®¤ä¸ºauthn_denyallï¼Œå³æ‹’ç»æ‰€æœ‰ç”¨æˆ·ç™»é™†ã€‚</p>

<p>ä¸‹é¢è¯´æ˜ä¸‰ç§èƒ½è®¤è¯ç”¨æˆ·ç™»å½• cobbler_web çš„æ–¹å¼</p>

<ol>
  <li>ä½¿ç”¨ authn_pam æ¨¡å—è®¤è¯ cobbler_web ç”¨æˆ·</li>
</ol>

<p>é¦–å…ˆä¿®æ”¹ modules ä¸­çš„ [authentication] æ®µä¸­çš„ module å‚æ•°çš„å€¼ä¸º authn_pam
æ¥ç€åˆ›å»ºç³»ç»Ÿç”¨æˆ·ï¼Œå¹¶ä¸ºç”¨æˆ·è®¾å®šå¯†ç ï¼Œè€Œåå°†è®¾å®šçš„ç³»ç»Ÿç”¨æˆ·æ·»åŠ è‡³ cobbler_web çš„ admin ç»„ä¸­ï¼Œä¿®æ”¹ /etc/cobbler/users.confæ–‡ä»¶ï¼Œ
å°†è®¾å®šçš„ç”¨æˆ·æ·»åŠ ä¸º admin å‚æ•°çš„å€¼å³å¯</p>

<ol>
  <li>
    <p>ä½¿ç”¨ authn_configfile æ¨¡å—è®¤è¯ cobbler_web ç”¨æˆ·
é¦–å…ˆä¿®æ”¹ modules ä¸­çš„ [authentication] æ®µä¸­çš„ module å‚æ•°çš„å€¼ä¸º authn_configfile
æ·»åŠ ç”¨æˆ·æ—¶ï¼Œéœ€è¦ä¸º htdigest å‘½ä»¤ä½¿ç”¨ â€œ-câ€ etc/cobbler/users.digestï¼Œåç»­æ·»åŠ å…¶ä»–ç”¨æˆ·åˆ™ä¸èƒ½å†ä½¿ç”¨ï¼ŒåŒæ­¥ cobblerï¼Œé‡å¯ httpd ä»¥åŠ cobbler</p>
  </li>
  <li>
    <p>ä½¿ç”¨ Cobbler é»˜è®¤çš„ Web è´¦å·å¯†ç è®¤è¯</p>

    <p>user:cobbler<br />
password:cobbler</p>
  </li>
</ol>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/etc/cobbler/users.conf       <span class="c"># WebæœåŠ¡æˆæƒé…ç½®æ–‡ä»¶</span>
/etc/cobbler/users.digest     <span class="c"># ç”¨äºwebè®¿é—®çš„ç”¨æˆ·åå¯†ç é…ç½®æ–‡ä»¶</span>
<span class="o">[</span>root@linux-node1 ~]# <span class="nb">cat</span> /etc/cobbler/users.digest
cobbler:Cobbler:a2d6bae81669d707b72c0bd9806e01f3
<span class="c"># è®¾ç½® Cobbler Web ç”¨æˆ·ç™»é™†å¯†ç </span>
<span class="o">[</span>root@linux-node1 ~]# htdigest /etc/cobbler/users.digest <span class="s2">"Cobbler"</span> cobbler
Changing password <span class="k">for </span>user cobbler <span class="k">in </span>realm Cobbler
New password: 123456
Re-type new password:123456
<span class="o">[</span>root@linux-node1 ~]# cobbler <span class="nb">sync</span>
<span class="o">[</span>root@linux-node1 ~]# systemctl restart httpd cobblerd
</code></pre></div></div>

<h3 id="72-cobbler-web-åŠŸèƒ½ç•Œé¢">7.2 Cobbler Web åŠŸèƒ½ç•Œé¢</h3>

<p><img src="https://raw.githubusercontent.com/JaminZhang/jaminzhang.github.io/master/images/Cobbler/Cobbler-Web-01-Distros.png" alt="Cobbler-Web-01-Distros.png" /><br />
<img src="https://raw.githubusercontent.com/JaminZhang/jaminzhang.github.io/master/images/Cobbler/Cobbler-Web-02-Profiles.png" alt="Cobbler-Web-02-Profiles.png" /><br />
<img src="https://raw.githubusercontent.com/JaminZhang/jaminzhang.github.io/master/images/Cobbler/Cobbler-Web-03-Systems.png" alt="Cobbler-Web-03-Systems.png" /><br />
<img src="https://raw.githubusercontent.com/JaminZhang/jaminzhang.github.io/master/images/Cobbler/Cobbler-Web-04-Repos.png" alt="Cobbler-Web-04-Repos.png" /></p>

<h2 id="8-cobbler-api-ä½¿ç”¨">8 Cobbler API ä½¿ç”¨</h2>

<p>cobbler_list.py è·å– Cobbler æœåŠ¡å™¨ä¸­çš„ distros/profiles/systems/images/repos ä¿¡æ¯ï¼Œä»£ç å¦‚ä¸‹ï¼š</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/python
</span><span class="kn">import</span> <span class="nn">xmlrpclib</span>
<span class="n">server</span> <span class="o">=</span> <span class="n">xmlrpclib</span><span class="o">.</span><span class="n">Server</span><span class="p">(</span><span class="s">"http://192.168.56.11/cobbler_api"</span><span class="p">)</span>
<span class="k">print</span> <span class="n">server</span><span class="o">.</span><span class="n">get_distros</span><span class="p">()</span>
<span class="k">print</span> <span class="n">server</span><span class="o">.</span><span class="n">get_profiles</span><span class="p">()</span>
<span class="k">print</span> <span class="n">server</span><span class="o">.</span><span class="n">get_systems</span><span class="p">()</span>
<span class="k">print</span> <span class="n">server</span><span class="o">.</span><span class="n">get_images</span><span class="p">()</span>
<span class="k">print</span> <span class="n">server</span><span class="o">.</span><span class="n">get_repos</span><span class="p">()</span>
</code></pre></div></div>

<p>cobbler_api.py é€šè¿‡ Cobber API æ·»åŠ  system</p>

<div class="language-python highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c1">#!/usr/bin/env python 
# -*- coding: utf-8 -*-
</span><span class="kn">import</span> <span class="nn">xmlrpclib</span> 

<span class="k">class</span> <span class="nc">CobblerAPI</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">url</span><span class="p">,</span><span class="n">user</span><span class="p">,</span><span class="n">password</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cobbler_user</span><span class="o">=</span> <span class="n">user</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cobbler_pass</span> <span class="o">=</span> <span class="n">password</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cobbler_url</span> <span class="o">=</span> <span class="n">url</span>
    
    <span class="k">def</span> <span class="nf">add_system</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">hostname</span><span class="p">,</span><span class="n">ip_add</span><span class="p">,</span><span class="n">mac_add</span><span class="p">,</span><span class="n">profile</span><span class="p">):</span>
        <span class="s">'''
        Add Cobbler System Infomation
        '''</span>
        <span class="n">ret</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s">"result"</span><span class="p">:</span> <span class="bp">True</span><span class="p">,</span>
            <span class="s">"comment"</span><span class="p">:</span> <span class="p">[],</span>
        <span class="p">}</span>
        <span class="c1">#get token
</span>        <span class="n">remote</span> <span class="o">=</span> <span class="n">xmlrpclib</span><span class="o">.</span><span class="n">Server</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cobbler_url</span><span class="p">)</span> 
        <span class="n">token</span> <span class="o">=</span> <span class="n">remote</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cobbler_user</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">cobbler_pass</span><span class="p">)</span> 
		
		<span class="c1">#add system
</span>        <span class="n">system_id</span> <span class="o">=</span> <span class="n">remote</span><span class="o">.</span><span class="n">new_system</span><span class="p">(</span><span class="n">token</span><span class="p">)</span> 
        <span class="n">remote</span><span class="o">.</span><span class="n">modify_system</span><span class="p">(</span><span class="n">system_id</span><span class="p">,</span><span class="s">"name"</span><span class="p">,</span><span class="n">hostname</span><span class="p">,</span><span class="n">token</span><span class="p">)</span> 
        <span class="n">remote</span><span class="o">.</span><span class="n">modify_system</span><span class="p">(</span><span class="n">system_id</span><span class="p">,</span><span class="s">"hostname"</span><span class="p">,</span><span class="n">hostname</span><span class="p">,</span><span class="n">token</span><span class="p">)</span> 
        <span class="n">remote</span><span class="o">.</span><span class="n">modify_system</span><span class="p">(</span><span class="n">system_id</span><span class="p">,</span><span class="s">'modify_interface'</span><span class="p">,</span> <span class="p">{</span> 
            <span class="s">"macaddress-eth0"</span> <span class="p">:</span> <span class="n">mac_add</span><span class="p">,</span> 
            <span class="s">"ipaddress-eth0"</span> <span class="p">:</span> <span class="n">ip_add</span><span class="p">,</span> 
            <span class="s">"dnsname-eth0"</span> <span class="p">:</span> <span class="n">hostname</span><span class="p">,</span> 
        <span class="p">},</span> <span class="n">token</span><span class="p">)</span> 
        <span class="n">remote</span><span class="o">.</span><span class="n">modify_system</span><span class="p">(</span><span class="n">system_id</span><span class="p">,</span><span class="s">"profile"</span><span class="p">,</span><span class="n">profile</span><span class="p">,</span><span class="n">token</span><span class="p">)</span> 
        <span class="n">remote</span><span class="o">.</span><span class="n">save_system</span><span class="p">(</span><span class="n">system_id</span><span class="p">,</span> <span class="n">token</span><span class="p">)</span> 
        <span class="k">try</span><span class="p">:</span>
            <span class="n">remote</span><span class="o">.</span><span class="n">sync</span><span class="p">(</span><span class="n">token</span><span class="p">)</span>
        <span class="k">except</span> <span class="nb">Exception</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
            <span class="n">ret</span><span class="p">[</span><span class="s">'result'</span><span class="p">]</span> <span class="o">=</span> <span class="bp">False</span>
            <span class="n">ret</span><span class="p">[</span><span class="s">'comment'</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">e</span><span class="p">))</span>
        <span class="k">return</span> <span class="n">ret</span>

<span class="k">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="n">cobbler</span> <span class="o">=</span> <span class="n">CobblerAPI</span><span class="p">(</span><span class="s">"http://192.168.56.11/cobbler_api"</span><span class="p">,</span><span class="s">"cobbler"</span><span class="p">,</span><span class="s">"cobbler"</span><span class="p">)</span>
    <span class="n">ret</span> <span class="o">=</span> <span class="n">cobbler</span><span class="o">.</span><span class="n">add_system</span><span class="p">(</span><span class="n">hostname</span><span class="o">=</span><span class="s">'cobbler-api-test'</span><span class="p">,</span><span class="n">ip_add</span><span class="o">=</span><span class="s">'192.168.56.11'</span><span class="p">,</span><span class="n">mac_add</span><span class="o">=</span><span class="s">'00:50:56:35:46:6F'</span><span class="p">,</span><span class="n">profile</span><span class="o">=</span><span class="s">'CentOS-7-x86_64'</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">ret</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">'__main__'</span><span class="p">:</span>
    <span class="n">main</span><span class="p">()</span>
</code></pre></div></div>

<p>æ‰§è¡Œæ­¤ Python è„šæœ¬æ­£ç¡®åè¾“å‡ºä¸ºï¼š</p>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="o">[</span>root@linux-node1 ~]# python cobbler_api.py 
<span class="o">{</span><span class="s1">'comment'</span>: <span class="o">[]</span>, <span class="s1">'result'</span>: True<span class="o">}</span>
<span class="o">[</span>root@linux-node1 ~]# cobbler system list
   cobbler-api-test
   jaminzhang.github.io
</code></pre></div></div>

<h1 id="ref">Ref</h1>
<p><a href="http://www.zyops.com/autoinstall-cobbler">COBBLERæ— äººå€¼å®ˆå®‰è£…</a><br />
<a href="http://www.xuliangwei.com/xubusi/446.html">Cobblerè‡ªåŠ¨åŒ–éƒ¨ç½²æœ€ä½³å®è·µ</a></p>

:ET